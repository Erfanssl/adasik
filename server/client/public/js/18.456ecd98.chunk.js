(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{478:function(e,t,n){"use strict";var r=n(118),a=n.n(r);var i=function(){var e=navigator.userAgent;return e.match(/(tablet|ipad|playbook|silk)|(android(?!.*mobi))/i)?"tablet":e.match(/Mobile|iP(hone|od)|Android|BlackBerry|IEMobile|Kindle|Silk-Accelerated|(hpw|web)OS|Opera M(obi|ini)/)?"mobile":"desktop"};var c=function(e){var t=new(window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection)({iceServers:[]}),n=function(){},r={},a=/([0-9]{1,3}(\.[0-9]{1,3}){3}|[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7})/g;function i(t){r[t]||e(t),r[t]=!0}t.createDataChannel(""),t.createOffer().then((function(e){e.sdp.split("\n").forEach((function(e){e.indexOf("candidate")<0||e.match(a).forEach(i)})),t.setLocalDescription(e,n,n)})).catch((function(e){})),t.onicecandidate=function(e){e&&e.candidate&&e.candidate.candidate&&e.candidate.candidate.match(a)&&e.candidate.candidate.match(a).forEach(i)}};t.a=function(){var e=a.a.connect("/pageview",{transports:["websocket"],upgrade:!1});return e.on("connect",(function(){})),e.on("visitorConnected",(function(){var t={pageviewUrl:window.location.pathname,httpReferer:document.referrer,deviceType:i()};c((function(n){t.ip||(t.ip=n,fetch("/api/pageview",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){return e.json()})).then((function(t){e.emit("viewData",t.data)})))}))})),e}},479:function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=n(65),c=n(10),o=n(156);function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}t.a=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(n){var r=n.identifier,i=s(n,["identifier"]);return r?r.NotAuthorizedError?(o.a.push("/sign-in"),a.a.createElement("div",null,"Redirecting...")):r.FetchError?a.a.createElement(c.a,{text:"Unable to fetch data. Try again"}):r.name||t?r.text||!r.name&&t?a.a.createElement(e,i):a.a.createElement(c.a,null):(o.a.push("/settings/profile"),a.a.createElement("div",null,"Redirecting...")):a.a.createElement(c.a,null)}function r(e){return{identifier:e.identifier}}return Object(i.b)(r,null)(a.a.memo(n))}},480:function(e,t,n){"use strict";var r=n(0),a=n.n(r);t.a=function(){return a.a.createElement("div",{className:"spinner"})}},481:function(e,t,n){"use strict";t.a=function(e){var t,n=!1;Number(e)<0&&(n=!0),t=n?Number(e).toString().split("").slice(1):Number(e).toString().split("");for(var r=[],a=0;t.length;)r.unshift(t.pop()),++a>=3&&(r.unshift(","),a=0);var i=r.join("").replace(/(^,|,$)/g,"");return n?"-"+i:i}},483:function(e,t,n){"use strict";t.a=function(e){var t=e.toString().length;return t<=3?e.toString():t<=5?(Math.floor(e/100)/10).toString()+"k":t<=6?Math.floor(e/1e3).toString()+"k":t<=8?(Math.floor(e/1e5)/10).toString()+"m":t<=9?Math.floor(e/1e6).toString()+"m":t<=11?(Math.floor(e/1e8)/10).toString()+"b":t<=12?Math.floor(e/1e9).toString()+"b":void 0}},486:function(e,t,n){"use strict";t.a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;return(null==e?void 0:e.length)>=t?e.substr(0,t-3)+"...":e}},506:function(e,t,n){"use strict";t.a=n.p+"images/check.40ddaed01f9bba110c814ffd10826f9d.svg"},535:function(e,t,n){"use strict";t.a=n.p+"images/empty.cefba746e343e4e9c22453913882b3a0.svg"},538:function(e,t,n){"use strict";n.p},539:function(e,t,n){"use strict";t.a=n.p+"images/cross.7210ee727be6d609a35275597b4a1d09.svg"},540:function(e,t,n){"use strict";t.a=n.p+"images/alone.fe9f3f1427c812170dd6675517d2e260.svg"},746:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(66),c=n(65),o=n(93),s=n(39);function l(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function u(){}function f(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}function d(e){if(e&&e.then)return e.then(u)}function m(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}var p=n(481),y=n(479),h=n(156),v=n(478),E=n(10),b=n(486),g=n(483),j=n(480),N=(n(538),n(506)),q=n(539),w=n(540),O=n(535);function S(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var c,o=e[Symbol.iterator]();!(r=(c=o.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==o.return||o.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return _(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}t.default=Object(y.a)(Object(c.b)((function(e){return{friendsData:e.friends}}),{fetchFriendsData:function(){return m((function(e){return d(f((function(){return l(fetch("/api/friend/data/complete"),(function(t){return l(t.json(),(function(t){e({type:o.c,payload:t})}))}))}),u))}))},acceptFriendRequest:function(e){return m((function(t){return d(f((function(){return l(fetch("/api/friend/request/".concat(e)),(function(e){return l(e.json(),(function(e){t({type:o.a,payload:e}),t({type:s.d,payload:"decrement"})}))}))}),u))}))},rejectFriendRequest:function(e){return m((function(t){return d(f((function(){return l(fetch("/api/friend/request/".concat(e),{method:"DELETE"}),(function(e){return l(e.json(),(function(e){t({type:o.d,payload:e}),t({type:s.d,payload:"decrement"})}))}))}),u))}))},deleteFriend:function(e){return m((function(t){return d(f((function(){return l(fetch("/api/friend/delete/".concat(e),{method:"DELETE"}),(function(e){return l(e.json(),(function(e){t({type:o.b,payload:e})}))}))}),(function(){t({type:o.b,payload:{Error:"Error"}})})))}))}})((function(e){var t=e.friendsData,n=e.fetchFriendsData,c=e.friendsReFetch,o=e.acceptFriendRequest,s=e.rejectFriendRequest,l=e.deleteFriend,u=S(Object(r.useState)({type:""}),2),f=u[0],d=u[1],m=S(Object(r.useState)({show:!1,type:"",payload:{}}),2),y=m[0],_=m[1],k=S(Object(r.useState)(""),2),C=k[0],I=k[1],R=S(Object(r.useState)(!1),2),F=R[0],T=R[1],A=S(Object(r.useState)(!1),2),D=A[0],x=A[1],L=Object(r.useRef)(),M=Object(r.useRef)(),P=Object(r.useRef)(),Y=Object(r.useRef)(),J=Object(r.useRef)(),U=Object(r.useRef)();Object(r.useEffect)((function(){document.title="Adasik - Friends",n();var e=Object(v.a)();return function(){e.disconnect()}}),[]),Object(r.useEffect)((function(){c&&c[0]&&n()}),[c]),Object(r.useEffect)((function(){y.show&&U&&U.current&&U.current.classList.add("active"),y.show||U&&U.current&&U.current.classList.remove("active")}),[y]),Object(r.useEffect)((function(){if(t&&t.requestAccepted&&(T(!1),n(),d({type:"requestAccepted"}),setTimeout((function(){d({type:""})}),1300)),t&&t.requestRejected&&(T(!1),n(),d({type:"requestRejected"}),setTimeout((function(){d({type:""})}),1300)),t&&(!t.requestAccepted||!t.requestRejected))for(var e={requestItem1:L,requestItem2:M,requestItem3:P,requestItem4:Y,requestItem5:J},r=1;r<6;r++){var a=e["requestItem".concat(r)];a&&a.current&&(a.current.style.transform="translate(-50%, -50%)")}t&&t.requestError&&(d({type:"requestError"}),setTimeout((function(){d({type:""})}),1300)),t&&t.friendDeleted&&(n(),d({type:"friendDeleted"}),x(!1),setTimeout((function(){d({type:""})}),1300)),t&&t.friendError&&(d({type:"friendError"}),setTimeout((function(){d({type:""})}),1300))}),[t]);var z=Object(r.useCallback)((function(e,t){for(var n={requestItem1:L,requestItem2:M,requestItem3:P,requestItem4:Y,requestItem5:J},r=1;r<6;r++){var a=n["requestItem".concat(r)];a&&a.current&&(a.current.style.transition="all .4s",a.current.style.transform="translate(-50%, -42.5%)",1===r&&(a.current.style.opacity="0",a.current.style.visibility="hidden",a.current.style.transform="translate(-50%, 10%)"))}setTimeout((function(){e(t)}),300)}),[]);function B(){if(!t.friends.length)return a.a.createElement("div",{className:"friends--main__no-friends--container"},a.a.createElement("div",null,a.a.createElement("p",null,"It Seems you have no friends!"),a.a.createElement("p",null,"Start making some...")),a.a.createElement("img",{src:w.a,alt:"no-friends"}));var e=t.friends.filter((function(e){return e.username.toLowerCase().includes(C.toLowerCase())||e.fullName.toLowerCase().includes(C.toLowerCase())}));return a.a.createElement(a.a.Fragment,null,D&&a.a.createElement("div",{className:"spinner--container"},a.a.createElement(j.a,null)),a.a.createElement("ul",{className:"friends--main-group"},f&&"friendError"===f.type&&a.a.createElement("p",{className:"friends--friend__notification error"},"Operation Failed!"),f&&"friendDeleted"===f.type&&a.a.createElement("p",{className:"friends--friend__notification successful"},"Successfully deleted from you friends!"),e.map((function(e){return function(e){var t=e._id,n=e.status,r=e.avatar,c=e.username,o=e.fullName;function s(e){var t="friends--main__img-container";return t+="online"===e?" friends--item__online":" friends--item__offline"}function l(e){_({show:!0,type:"friend",payload:{id:e}})}return a.a.createElement("li",{className:"friends--main__item"},a.a.createElement("div",{className:s(n.text)+" hover"},a.a.createElement("img",{src:r,alt:o}),a.a.createElement("div",{className:"hover--container"},a.a.createElement(i.a,{to:"/profile/".concat(c)},o),a.a.createElement("img",{onClick:l.bind(null,t),src:q.a,alt:"delete"}))),a.a.createElement("div",{className:"friends--main__hover-none"},a.a.createElement("div",{className:"title--container"},a.a.createElement(i.a,{to:"/profile/".concat(c)},o)),a.a.createElement("div",{className:s(n.text)},a.a.createElement("img",{onClick:function(){h.a.push("/profile/".concat(c))},className:"image",src:r,alt:o})),a.a.createElement("div",{className:"btn--container"},a.a.createElement("img",{onClick:l.bind(null,t),src:q.a,alt:"delete"}))))}(e)}))))}function $(){return t&&!t.pending.length?a.a.createElement("div",{className:"friends--requests__no-request--container"},a.a.createElement("p",null,"You currently don't have any friend Requests"),a.a.createElement("img",{src:O.a,alt:"empty-folder"})):a.a.createElement("ul",{className:"friends--requests-group"},function(){function e(e){var t="friends--item__img-container";return"online"===e.text?t+=" friends--item__online":t+=" friends--item__offline",t}function n(e){z(o,e),T(!0)}function r(e){_({show:!0,type:"request",payload:{id:e}})}return t.pending.map((function(t,c){var o=t._id,s=t.avatar,l=t.username,u=t.fullName,f=t.status,d=t.whole,m=d.games,y=d.level,h=d.rank,v=d.totalScore,E=d.trainingScore,j="requestItem"+(c+1),w={requestItem1:L,requestItem2:M,requestItem3:P,requestItem4:Y,requestItem5:J};return a.a.createElement("li",{key:o,ref:w[j],className:"friends--request-item"},a.a.createElement(i.a,{to:"/profile/".concat(l),className:e(f)},a.a.createElement("img",{src:s,alt:"person"})),a.a.createElement("div",{className:"friends--item__meta-data-container"},a.a.createElement("div",null,a.a.createElement(i.a,{to:"/profile/".concat(l)},Object(b.a)(u,14)),a.a.createElement("p",null,Object(p.a)(m.total)," Challenge",m.total>=2?"s":"")),a.a.createElement("div",null,a.a.createElement("p",null,a.a.createElement("span",null,"Total Score:")," ",v<0?"-"+Object(g.a)(v.toString().substring(1)):Object(g.a)(v)),a.a.createElement("p",null,a.a.createElement("span",null,"Training Score:")," ",E<0?"-"+Object(g.a)(E.toString().substring(1)):Object(g.a)(E)),a.a.createElement("p",null,a.a.createElement("span",null,"Rank:")," ",Object(g.a)(h)),a.a.createElement("p",null,a.a.createElement("span",null,"Level:")," ",Object(p.a)(y.level)))),a.a.createElement("div",{className:"friends--item__icon-container"},a.a.createElement("img",{onClick:n.bind(null,o),src:N.a,alt:"confirm"}),a.a.createElement("img",{onClick:r.bind(null,o),src:q.a,alt:"reject"})))}))}())}return a.a.createElement("div",{className:"friends--container",style:y.show?{height:"93vh",overflow:"hidden"}:{}},(!t||!t.pending)&&a.a.createElement(E.a,null),y.show&&a.a.createElement("div",{className:"friends--pop-up__container"},a.a.createElement("div",{ref:U,className:"card"},"request"===y.type?a.a.createElement(a.a.Fragment,null,a.a.createElement("p",null,"Are you sure you want to reject this request?"),a.a.createElement("div",null,a.a.createElement("button",{onClick:function(){z(s,y.payload.id),_({show:!1,type:"",payload:{}}),T(!0)},className:"yes--btn"},"Yes"),a.a.createElement("button",{onClick:function(){_({show:!1,type:"",payload:{}})},className:"no--btn"},"No"))):"friend"===y.type?a.a.createElement(a.a.Fragment,null,a.a.createElement("p",null,"Are you sure you want to delete this person from your friends?"),a.a.createElement("div",null,a.a.createElement("button",{onClick:function(){l(y.payload.id),_({show:!1,type:"",payload:{}}),x(!0)},className:"yes--btn"},"Yes"),a.a.createElement("button",{onClick:function(){_({show:!1,type:"",payload:{}})},className:"no--btn"},"No"))):void 0)),t&&t.pending&&a.a.createElement("div",{className:"friends--requests-container"},a.a.createElement("h2",{className:"friends--ribbon"},a.a.createElement("p",{className:"friends--ribbon-content"},0===t.pending.length?"No":t.pending.length," Friend Request",t.pending.length>=2?"s":"")),F&&a.a.createElement("div",{className:"spinner--container"},a.a.createElement(j.a,null)),f&&"requestError"===f.type&&a.a.createElement("p",{className:"friends--requests__notification error"},"Operation Failed!"),f&&"requestAccepted"===f.type&&a.a.createElement("p",{className:"friends--requests__notification successful"},"Successfully added to your friends!"),f&&"requestRejected"===f.type&&a.a.createElement("p",{className:"friends--requests__notification successful"},"Successfully rejected!"),$()),t&&t.friends&&a.a.createElement("div",{className:"friends--main-container"},a.a.createElement("div",{className:"friends--ribbon-container"},a.a.createElement("h2",{className:"friends--ribbon"},a.a.createElement("p",{className:"friends--ribbon-content"},"You Have ",0===t.friends.length?"no":t.friends.length," Friend",t.friends.length>=2?"s":""))),!!t.friends.length&&a.a.createElement("input",{type:"text",className:"friends--main__input",placeholder:"Search among your friends by their username or name",value:C,onChange:function(e){I(e.target.value)}}),B()))})))}}]);